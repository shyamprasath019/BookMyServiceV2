{"ast":null,"code":"var _jsxFileName = \"D:\\\\Data\\\\Project\\\\claude ai\\\\BookMyServiceV2\\\\client\\\\src\\\\pages\\\\Messages.js\",\n  _s = $RefreshSig$();\n// client/src/pages/Messages.js\nimport React, { useState, useEffect, useContext } from 'react';\nimport { Link, useNavigate } from 'react-router-dom';\nimport { AuthContext } from '../context/AuthContext';\nimport api from '../utils/api';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst Messages = () => {\n  _s();\n  const {\n    currentUser\n  } = useContext(AuthContext);\n  const navigate = useNavigate();\n  const [conversations, setConversations] = useState([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState('');\n  const [searchQuery, setSearchQuery] = useState('');\n  const [filteredConversations, setFilteredConversations] = useState([]);\n  const [selectedTab, setSelectedTab] = useState('all');\n  useEffect(() => {\n    handleRedirectFromContact();\n  }, []);\n  useEffect(() => {\n    fetchConversations();\n  }, []);\n  useEffect(() => {\n    // Filter conversations based on search query and selected tab\n    if (conversations.length > 0) {\n      let filtered = [...conversations];\n\n      // Filter by tab\n      if (selectedTab === 'orders') {\n        filtered = filtered.filter(conv => conv.order);\n      } else if (selectedTab === 'unread') {\n        filtered = filtered.filter(conv => conv.unreadCount > 0);\n      }\n\n      // Filter by search query\n      if (searchQuery.trim() !== '') {\n        const query = searchQuery.toLowerCase();\n        filtered = filtered.filter(conv => {\n          const otherUser = conv.participants.find(p => p._id !== currentUser._id);\n\n          // Search by user name\n          if (otherUser.username.toLowerCase().includes(query)) {\n            return true;\n          }\n\n          // Search by order title\n          if (conv.order && conv.order.title.toLowerCase().includes(query)) {\n            return true;\n          }\n\n          // Search in last message\n          if (conv.lastMessage && conv.lastMessage.content && conv.lastMessage.content.toLowerCase().includes(query)) {\n            return true;\n          }\n          return false;\n        });\n      }\n      setFilteredConversations(filtered);\n    }\n  }, [conversations, searchQuery, selectedTab, currentUser]);\n  const fetchConversations = async () => {\n    setIsLoading(true);\n    try {\n      const response = await api.get('/messages/conversations');\n\n      // Populate conversations with more data\n      if (response.data && Array.isArray(response.data)) {\n        // Sort conversations by most recent first\n        const sortedConversations = response.data.sort((a, b) => new Date(b.updatedAt) - new Date(a.updatedAt));\n        setConversations(sortedConversations);\n        setFilteredConversations(sortedConversations);\n      } else {\n        setConversations([]);\n        setFilteredConversations([]);\n      }\n    } catch (err) {\n      var _err$response, _err$response$data;\n      console.error('Error fetching conversations:', err);\n      setError(((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.message) || 'Failed to load conversations');\n      setConversations([]);\n      setFilteredConversations([]);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  const handleRedirectFromContact = () => {\n    const params = new URLSearchParams(window.location.search);\n    const targetUserId = params.get('user');\n    const orderId = params.get('order');\n\n    // If there's a userId or orderId in the URL, try to create a conversation and redirect\n    if (targetUserId || orderId) {\n      // Set loading indication\n      setIsLoading(true);\n      const fetchInitialConversation = async () => {\n        try {\n          let response;\n          if (targetUserId) {\n            // Create/get conversation with this user\n            response = await api.get(`/messages/conversation/user/${targetUserId}`);\n          } else if (orderId) {\n            // Create/get conversation for this order\n            response = await api.get(`/messages/conversation/order/${orderId}`);\n          }\n          if (response && response.data && response.data._id) {\n            // Navigate to the new conversation\n            navigate(`/messages/${response.data._id}`, {\n              replace: true\n            });\n            return; // Exit the function after redirect\n          }\n        } catch (err) {\n          console.error('Error creating conversation from params:', err);\n          setError('Failed to start requested conversation');\n        } finally {\n          setIsLoading(false);\n        }\n      };\n      fetchInitialConversation();\n    }\n  };\n\n  // Get the other participant for each conversation\n  const getOtherParticipant = conversation => {\n    if (!conversation || !conversation.participants || !Array.isArray(conversation.participants)) {\n      // Return a default participant object if data is invalid\n      return {\n        username: 'User',\n        _id: 'unknown',\n        profileImage: null\n      };\n    }\n\n    // Find participant who is not the current user\n    const otherParticipant = conversation.participants.find(participant => participant && participant._id !== (currentUser === null || currentUser === void 0 ? void 0 : currentUser._id));\n\n    // Return the other participant or a default object if not found\n    return otherParticipant || {\n      username: 'User',\n      _id: 'unknown',\n      profileImage: null\n    };\n  };\n  const startNewConversation = async userId => {\n    if (!userId) return;\n    try {\n      setIsLoading(true);\n      const response = await api.get(`/messages/conversation/user/${userId}`);\n      if (response.data && response.data._id) {\n        // Navigate to the new conversation\n        navigate(`/messages/${response.data._id}`);\n      }\n    } catch (err) {\n      console.error('Error starting new conversation:', err);\n      setError('Failed to start new conversation');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // Format timestamp to show either time or date\n  const formatTime = timestamp => {\n    const messageDate = new Date(timestamp);\n    const today = new Date();\n    const yesterday = new Date(today);\n    yesterday.setDate(yesterday.getDate() - 1);\n    if (messageDate.toDateString() === today.toDateString()) {\n      // Today, show time\n      return messageDate.toLocaleTimeString([], {\n        hour: '2-digit',\n        minute: '2-digit'\n      });\n    } else if (messageDate.toDateString() === yesterday.toDateString()) {\n      // Yesterday\n      return 'Yesterday';\n    } else {\n      // Other days, show date\n      return messageDate.toLocaleDateString([], {\n        month: 'short',\n        day: 'numeric'\n      });\n    }\n  };\n  const handleSearchChange = e => {\n    setSearchQuery(e.target.value);\n  };\n  const clearSearch = () => {\n    setSearchQuery('');\n  };\n  const handleTabChange = tab => {\n    setSelectedTab(tab);\n  };\n  if (isLoading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex justify-center items-center py-12\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"inline-block animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 204,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"ml-2\",\n        children: \"Loading conversations...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 205,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 7\n    }, this);\n  }\n  if (error) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"max-w-4xl mx-auto mt-20 p-8 bg-white shadow rounded-lg\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-red-100 text-red-700 p-4 rounded mb-4\",\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 213,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => navigate('/dashboard'),\n        className: \"text-blue-500 hover:underline\",\n        children: \"\\u2190 Back to Dashboard\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 216,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 7\n    }, this);\n  }\n  const totalUnread = conversations.reduce((sum, conv) => sum + (conv.unreadCount || 0), 0);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"max-w-4xl mx-auto mt-20\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-white shadow rounded-lg overflow-hidden\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-blue-500 text-white p-4\",\n        children: /*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"text-xl font-bold\",\n          children: \"Messages\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 232,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 231,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-4 border-b border-gray-200\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex flex-col md:flex-row md:justify-between md:items-center gap-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex flex-wrap gap-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              className: `px-3 py-1.5 rounded-full transition ${selectedTab === 'all' ? 'bg-blue-100 text-blue-700' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'}`,\n              onClick: () => handleTabChange('all'),\n              children: \"All\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 239,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: `px-3 py-1.5 rounded-full transition flex items-center ${selectedTab === 'unread' ? 'bg-blue-100 text-blue-700' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'}`,\n              onClick: () => handleTabChange('unread'),\n              children: [\"Unread\", totalUnread > 0 && /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"ml-1 bg-blue-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center\",\n                children: totalUnread\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 259,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 249,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: `px-3 py-1.5 rounded-full transition ${selectedTab === 'orders' ? 'bg-blue-100 text-blue-700' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'}`,\n              onClick: () => handleTabChange('orders'),\n              children: \"Orders\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 264,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 238,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"relative w-full md:w-60\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              className: \"w-full bg-gray-100 border border-gray-300 rounded-full pl-10 pr-10 py-2 focus:outline-none focus:border-blue-500\",\n              placeholder: \"Search messages...\",\n              value: searchQuery,\n              onChange: handleSearchChange\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 277,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500\",\n              children: /*#__PURE__*/_jsxDEV(\"svg\", {\n                xmlns: \"http://www.w3.org/2000/svg\",\n                className: \"h-5 w-5\",\n                fill: \"none\",\n                viewBox: \"0 0 24 24\",\n                stroke: \"currentColor\",\n                children: /*#__PURE__*/_jsxDEV(\"path\", {\n                  strokeLinecap: \"round\",\n                  strokeLinejoin: \"round\",\n                  strokeWidth: 2,\n                  d: \"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 286,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 285,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 284,\n              columnNumber: 15\n            }, this), searchQuery && /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700\",\n              onClick: clearSearch,\n              children: /*#__PURE__*/_jsxDEV(\"svg\", {\n                xmlns: \"http://www.w3.org/2000/svg\",\n                className: \"h-5 w-5\",\n                fill: \"none\",\n                viewBox: \"0 0 24 24\",\n                stroke: \"currentColor\",\n                children: /*#__PURE__*/_jsxDEV(\"path\", {\n                  strokeLinecap: \"round\",\n                  strokeLinejoin: \"round\",\n                  strokeWidth: 2,\n                  d: \"M6 18L18 6M6 6l12 12\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 295,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 294,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 290,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 276,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 237,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 236,\n        columnNumber: 9\n      }, this), filteredConversations.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-8 text-center\",\n        children: conversations.length === 0 ? /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-6xl mb-4\",\n            children: \"\\uD83D\\uDCAC\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 307,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-gray-500 mb-4\",\n            children: \"You don't have any messages yet.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 308,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-gray-500 mb-4\",\n            children: \"Start a conversation by contacting a freelancer or responding to a job request.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 309,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(Link, {\n            to: \"/dashboard\",\n            className: \"text-blue-500 hover:underline\",\n            children: \"\\u2190 Back to Dashboard\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 312,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-6xl mb-4\",\n            children: \"\\uD83D\\uDD0D\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 321,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-gray-500 mb-4\",\n            children: \"No conversations found matching your search criteria.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 322,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: clearSearch,\n            className: \"text-blue-500 hover:underline\",\n            children: \"Clear search\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 323,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 304,\n        columnNumber: 13\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"divide-y max-h-[calc(100vh-300px)] overflow-y-auto\",\n        children: filteredConversations.map(conversation => {\n          var _conversation$lastMes;\n          const otherParticipant = getOtherParticipant(conversation);\n          const hasUnread = conversation.unreadCount > 0;\n          return /*#__PURE__*/_jsxDEV(Link, {\n            to: `/messages/${conversation._id}`,\n            className: `block p-4 hover:bg-gray-50 transition ${hasUnread ? 'bg-blue-50' : ''}`,\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"relative\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"h-12 w-12 rounded-full bg-blue-500 text-white flex items-center justify-center font-bold mr-4 overflow-hidden\",\n                  children: otherParticipant !== null && otherParticipant !== void 0 && otherParticipant.profileImage ? /*#__PURE__*/_jsxDEV(\"img\", {\n                    src: otherParticipant.profileImage,\n                    alt: otherParticipant.username,\n                    className: \"h-12 w-12 rounded-full object-cover\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 348,\n                    columnNumber: 27\n                  }, this) : otherParticipant === null || otherParticipant === void 0 ? void 0 : otherParticipant.username.charAt(0).toUpperCase()\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 346,\n                  columnNumber: 23\n                }, this), hasUnread && /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center border-2 border-white\",\n                  children: conversation.unreadCount\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 358,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 345,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex-1 min-w-0\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex justify-between items-center\",\n                  children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                    className: `text-sm font-medium truncate ${hasUnread ? 'text-blue-700 font-semibold' : 'text-gray-900'}`,\n                    children: otherParticipant === null || otherParticipant === void 0 ? void 0 : otherParticipant.username\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 366,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-xs text-gray-500 whitespace-nowrap ml-2\",\n                    children: formatTime(conversation.updatedAt)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 369,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 365,\n                  columnNumber: 23\n                }, this), conversation.order && /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex items-center mt-1\",\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: `text-xs px-2 py-0.5 rounded-full ${conversation.order.status === 'completed' ? 'bg-green-100 text-green-800' : conversation.order.status === 'in_progress' ? 'bg-blue-100 text-blue-800' : conversation.order.status === 'pending' ? 'bg-yellow-100 text-yellow-800' : conversation.order.status === 'under_review' ? 'bg-purple-100 text-purple-800' : 'bg-gray-100 text-gray-800'}`,\n                    children: [\"Order: \", conversation.order.status.replace('_', ' ')]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 376,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-xs text-gray-500 ml-2 truncate\",\n                    children: conversation.order.title\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 389,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 375,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: `text-sm truncate mt-1 ${hasUnread ? 'text-gray-900' : 'text-gray-500'}`,\n                  children: conversation.lastMessage ? /*#__PURE__*/_jsxDEV(_Fragment, {\n                    children: [conversation.lastMessage.sender._id === currentUser._id && \"You: \", conversation.lastMessage.content ? conversation.lastMessage.content : (_conversation$lastMes = conversation.lastMessage.attachments) !== null && _conversation$lastMes !== void 0 && _conversation$lastMes.length ? `${conversation.lastMessage.attachments.length} attachment${conversation.lastMessage.attachments.length !== 1 ? 's' : ''}` : 'Empty message']\n                  }, void 0, true) : 'No messages yet'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 395,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 364,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 344,\n              columnNumber: 19\n            }, this)\n          }, conversation._id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 339,\n            columnNumber: 17\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 333,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 230,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 229,\n    columnNumber: 5\n  }, this);\n};\n_s(Messages, \"a2wyRF9UGkYN4XlEvBIEfNzvWiw=\", false, function () {\n  return [useNavigate];\n});\n_c = Messages;\nexport default Messages;\nvar _c;\n$RefreshReg$(_c, \"Messages\");","map":{"version":3,"names":["React","useState","useEffect","useContext","Link","useNavigate","AuthContext","api","jsxDEV","_jsxDEV","Fragment","_Fragment","Messages","_s","currentUser","navigate","conversations","setConversations","isLoading","setIsLoading","error","setError","searchQuery","setSearchQuery","filteredConversations","setFilteredConversations","selectedTab","setSelectedTab","handleRedirectFromContact","fetchConversations","length","filtered","filter","conv","order","unreadCount","trim","query","toLowerCase","otherUser","participants","find","p","_id","username","includes","title","lastMessage","content","response","get","data","Array","isArray","sortedConversations","sort","a","b","Date","updatedAt","err","_err$response","_err$response$data","console","message","params","URLSearchParams","window","location","search","targetUserId","orderId","fetchInitialConversation","replace","getOtherParticipant","conversation","profileImage","otherParticipant","participant","startNewConversation","userId","formatTime","timestamp","messageDate","today","yesterday","setDate","getDate","toDateString","toLocaleTimeString","hour","minute","toLocaleDateString","month","day","handleSearchChange","e","target","value","clearSearch","handleTabChange","tab","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","totalUnread","reduce","sum","type","placeholder","onChange","xmlns","fill","viewBox","stroke","strokeLinecap","strokeLinejoin","strokeWidth","d","to","map","_conversation$lastMes","hasUnread","src","alt","charAt","toUpperCase","status","sender","attachments","_c","$RefreshReg$"],"sources":["D:/Data/Project/claude ai/BookMyServiceV2/client/src/pages/Messages.js"],"sourcesContent":["// client/src/pages/Messages.js\r\nimport React, { useState, useEffect, useContext } from 'react';\r\nimport { Link, useNavigate } from 'react-router-dom';\r\nimport { AuthContext } from '../context/AuthContext';\r\nimport api from '../utils/api';\r\n\r\nconst Messages = () => {\r\n  const { currentUser } = useContext(AuthContext);\r\n  const navigate = useNavigate();\r\n  \r\n  const [conversations, setConversations] = useState([]);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [error, setError] = useState('');\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [filteredConversations, setFilteredConversations] = useState([]);\r\n  const [selectedTab, setSelectedTab] = useState('all');\r\n  \r\n  useEffect(() => {\r\n    handleRedirectFromContact();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    fetchConversations();\r\n  }, []);\r\n  \r\n  useEffect(() => {\r\n    // Filter conversations based on search query and selected tab\r\n    if (conversations.length > 0) {\r\n      let filtered = [...conversations];\r\n      \r\n      // Filter by tab\r\n      if (selectedTab === 'orders') {\r\n        filtered = filtered.filter(conv => conv.order);\r\n      } else if (selectedTab === 'unread') {\r\n        filtered = filtered.filter(conv => conv.unreadCount > 0);\r\n      }\r\n      \r\n      // Filter by search query\r\n      if (searchQuery.trim() !== '') {\r\n        const query = searchQuery.toLowerCase();\r\n        filtered = filtered.filter(conv => {\r\n          const otherUser = conv.participants.find(p => p._id !== currentUser._id);\r\n          \r\n          // Search by user name\r\n          if (otherUser.username.toLowerCase().includes(query)) {\r\n            return true;\r\n          }\r\n          \r\n          // Search by order title\r\n          if (conv.order && conv.order.title.toLowerCase().includes(query)) {\r\n            return true;\r\n          }\r\n          \r\n          // Search in last message\r\n          if (conv.lastMessage && conv.lastMessage.content && \r\n              conv.lastMessage.content.toLowerCase().includes(query)) {\r\n            return true;\r\n          }\r\n          \r\n          return false;\r\n        });\r\n      }\r\n      \r\n      setFilteredConversations(filtered);\r\n    }\r\n  }, [conversations, searchQuery, selectedTab, currentUser]);\r\n  \r\n  const fetchConversations = async () => {\r\n    setIsLoading(true);\r\n    try {\r\n      const response = await api.get('/messages/conversations');\r\n      \r\n      // Populate conversations with more data\r\n      if (response.data && Array.isArray(response.data)) {\r\n        // Sort conversations by most recent first\r\n        const sortedConversations = response.data.sort((a, b) => \r\n          new Date(b.updatedAt) - new Date(a.updatedAt)\r\n        );\r\n        \r\n        setConversations(sortedConversations);\r\n        setFilteredConversations(sortedConversations);\r\n      } else {\r\n        setConversations([]);\r\n        setFilteredConversations([]);\r\n      }\r\n    } catch (err) {\r\n      console.error('Error fetching conversations:', err);\r\n      setError(err.response?.data?.message || 'Failed to load conversations');\r\n      setConversations([]);\r\n      setFilteredConversations([]);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleRedirectFromContact = () => {\r\n    const params = new URLSearchParams(window.location.search);\r\n    const targetUserId = params.get('user');\r\n    const orderId = params.get('order');\r\n    \r\n    // If there's a userId or orderId in the URL, try to create a conversation and redirect\r\n    if (targetUserId || orderId) {\r\n      // Set loading indication\r\n      setIsLoading(true);\r\n      \r\n      const fetchInitialConversation = async () => {\r\n        try {\r\n          let response;\r\n          \r\n          if (targetUserId) {\r\n            // Create/get conversation with this user\r\n            response = await api.get(`/messages/conversation/user/${targetUserId}`);\r\n          } else if (orderId) {\r\n            // Create/get conversation for this order\r\n            response = await api.get(`/messages/conversation/order/${orderId}`);\r\n          }\r\n          \r\n          if (response && response.data && response.data._id) {\r\n            // Navigate to the new conversation\r\n            navigate(`/messages/${response.data._id}`, { replace: true });\r\n            return; // Exit the function after redirect\r\n          }\r\n        } catch (err) {\r\n          console.error('Error creating conversation from params:', err);\r\n          setError('Failed to start requested conversation');\r\n        } finally {\r\n          setIsLoading(false);\r\n        }\r\n      };\r\n      \r\n      fetchInitialConversation();\r\n    }\r\n  };\r\n  \r\n  // Get the other participant for each conversation\r\n  const getOtherParticipant = (conversation) => {\r\n    if (!conversation || !conversation.participants || !Array.isArray(conversation.participants)) {\r\n      // Return a default participant object if data is invalid\r\n      return { username: 'User', _id: 'unknown', profileImage: null };\r\n    }\r\n    \r\n    // Find participant who is not the current user\r\n    const otherParticipant = conversation.participants.find(\r\n      participant => participant && participant._id !== currentUser?._id\r\n    );\r\n    \r\n    // Return the other participant or a default object if not found\r\n    return otherParticipant || { username: 'User', _id: 'unknown', profileImage: null };\r\n  };\r\n\r\n  const startNewConversation = async (userId) => {\r\n    if (!userId) return;\r\n    \r\n    try {\r\n      setIsLoading(true);\r\n      const response = await api.get(`/messages/conversation/user/${userId}`);\r\n      \r\n      if (response.data && response.data._id) {\r\n        // Navigate to the new conversation\r\n        navigate(`/messages/${response.data._id}`);\r\n      }\r\n    } catch (err) {\r\n      console.error('Error starting new conversation:', err);\r\n      setError('Failed to start new conversation');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n  \r\n  // Format timestamp to show either time or date\r\n  const formatTime = (timestamp) => {\r\n    const messageDate = new Date(timestamp);\r\n    const today = new Date();\r\n    const yesterday = new Date(today);\r\n    yesterday.setDate(yesterday.getDate() - 1);\r\n    \r\n    if (messageDate.toDateString() === today.toDateString()) {\r\n      // Today, show time\r\n      return messageDate.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\r\n    } else if (messageDate.toDateString() === yesterday.toDateString()) {\r\n      // Yesterday\r\n      return 'Yesterday';\r\n    } else {\r\n      // Other days, show date\r\n      return messageDate.toLocaleDateString([], { month: 'short', day: 'numeric' });\r\n    }\r\n  };\r\n  \r\n  const handleSearchChange = (e) => {\r\n    setSearchQuery(e.target.value);\r\n  };\r\n  \r\n  const clearSearch = () => {\r\n    setSearchQuery('');\r\n  };\r\n  \r\n  const handleTabChange = (tab) => {\r\n    setSelectedTab(tab);\r\n  };\r\n  \r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"flex justify-center items-center py-12\">\r\n        <div className=\"inline-block animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500\"></div>\r\n        <p className=\"ml-2\">Loading conversations...</p>\r\n      </div>\r\n    );\r\n  }\r\n  \r\n  if (error) {\r\n    return (\r\n      <div className=\"max-w-4xl mx-auto mt-20 p-8 bg-white shadow rounded-lg\">\r\n        <div className=\"bg-red-100 text-red-700 p-4 rounded mb-4\">\r\n          {error}\r\n        </div>\r\n        <button\r\n          onClick={() => navigate('/dashboard')}\r\n          className=\"text-blue-500 hover:underline\"\r\n        >\r\n          &larr; Back to Dashboard\r\n        </button>\r\n      </div>\r\n    );\r\n  }\r\n  \r\n  const totalUnread = conversations.reduce((sum, conv) => sum + (conv.unreadCount || 0), 0);\r\n  \r\n  return (\r\n    <div className=\"max-w-4xl mx-auto mt-20\">\r\n      <div className=\"bg-white shadow rounded-lg overflow-hidden\">\r\n        <div className=\"bg-blue-500 text-white p-4\">\r\n          <h1 className=\"text-xl font-bold\">Messages</h1>\r\n        </div>\r\n        \r\n        {/* Tabs and Search */}\r\n        <div className=\"p-4 border-b border-gray-200\">\r\n          <div className=\"flex flex-col md:flex-row md:justify-between md:items-center gap-3\">\r\n            <div className=\"flex flex-wrap gap-2\">\r\n              <button\r\n                className={`px-3 py-1.5 rounded-full transition ${\r\n                  selectedTab === 'all' \r\n                    ? 'bg-blue-100 text-blue-700' \r\n                    : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\r\n                }`}\r\n                onClick={() => handleTabChange('all')}\r\n              >\r\n                All\r\n              </button>\r\n              <button\r\n                className={`px-3 py-1.5 rounded-full transition flex items-center ${\r\n                  selectedTab === 'unread' \r\n                    ? 'bg-blue-100 text-blue-700' \r\n                    : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\r\n                }`}\r\n                onClick={() => handleTabChange('unread')}\r\n              >\r\n                Unread\r\n                {totalUnread > 0 && (\r\n                  <span className=\"ml-1 bg-blue-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center\">\r\n                    {totalUnread}\r\n                  </span>\r\n                )}\r\n              </button>\r\n              <button\r\n                className={`px-3 py-1.5 rounded-full transition ${\r\n                  selectedTab === 'orders' \r\n                    ? 'bg-blue-100 text-blue-700' \r\n                    : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\r\n                }`}\r\n                onClick={() => handleTabChange('orders')}\r\n              >\r\n                Orders\r\n              </button>\r\n            </div>\r\n            \r\n            <div className=\"relative w-full md:w-60\">\r\n              <input\r\n                type=\"text\"\r\n                className=\"w-full bg-gray-100 border border-gray-300 rounded-full pl-10 pr-10 py-2 focus:outline-none focus:border-blue-500\"\r\n                placeholder=\"Search messages...\"\r\n                value={searchQuery}\r\n                onChange={handleSearchChange}\r\n              />\r\n              <div className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500\">\r\n                <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z\" />\r\n                </svg>\r\n              </div>\r\n              {searchQuery && (\r\n                <button\r\n                  className=\"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700\"\r\n                  onClick={clearSearch}\r\n                >\r\n                  <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\r\n                  </svg>\r\n                </button>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n        \r\n        {filteredConversations.length === 0 ? (\r\n            <div className=\"p-8 text-center\">\r\n            {conversations.length === 0 ? (\r\n              <>\r\n                <div className=\"text-6xl mb-4\">üí¨</div>\r\n                <p className=\"text-gray-500 mb-4\">You don't have any messages yet.</p>\r\n                <p className=\"text-gray-500 mb-4\">\r\n                  Start a conversation by contacting a freelancer or responding to a job request.\r\n                </p>\r\n                <Link\r\n                  to=\"/dashboard\"\r\n                  className=\"text-blue-500 hover:underline\"\r\n                >\r\n                  &larr; Back to Dashboard\r\n                </Link>\r\n              </>\r\n            ) : (\r\n              <>\r\n                <div className=\"text-6xl mb-4\">üîç</div>\r\n                <p className=\"text-gray-500 mb-4\">No conversations found matching your search criteria.</p>\r\n                <button\r\n                  onClick={clearSearch}\r\n                  className=\"text-blue-500 hover:underline\"\r\n                >\r\n                  Clear search\r\n                </button>\r\n              </>\r\n            )}\r\n          </div>\r\n        ) : (\r\n          <div className=\"divide-y max-h-[calc(100vh-300px)] overflow-y-auto\">\r\n            {filteredConversations.map(conversation => {\r\n              const otherParticipant = getOtherParticipant(conversation);\r\n              const hasUnread = conversation.unreadCount > 0;\r\n              \r\n              return (\r\n                <Link\r\n                  key={conversation._id}\r\n                  to={`/messages/${conversation._id}`}\r\n                  className={`block p-4 hover:bg-gray-50 transition ${hasUnread ? 'bg-blue-50' : ''}`}\r\n                >\r\n                  <div className=\"flex items-center\">\r\n                    <div className=\"relative\">\r\n                      <div className=\"h-12 w-12 rounded-full bg-blue-500 text-white flex items-center justify-center font-bold mr-4 overflow-hidden\">\r\n                        {otherParticipant?.profileImage ? (\r\n                          <img\r\n                            src={otherParticipant.profileImage}\r\n                            alt={otherParticipant.username}\r\n                            className=\"h-12 w-12 rounded-full object-cover\"\r\n                          />\r\n                        ) : (\r\n                          otherParticipant?.username.charAt(0).toUpperCase()\r\n                        )}\r\n                      </div>\r\n                      {hasUnread && (\r\n                        <div className=\"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center border-2 border-white\">\r\n                          {conversation.unreadCount}\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                    \r\n                    <div className=\"flex-1 min-w-0\">\r\n                      <div className=\"flex justify-between items-center\">\r\n                        <h3 className={`text-sm font-medium truncate ${hasUnread ? 'text-blue-700 font-semibold' : 'text-gray-900'}`}>\r\n                          {otherParticipant?.username}\r\n                        </h3>\r\n                        <span className=\"text-xs text-gray-500 whitespace-nowrap ml-2\">\r\n                          {formatTime(conversation.updatedAt)}\r\n                        </span>\r\n                      </div>\r\n                      \r\n                      {conversation.order && (\r\n                        <div className=\"flex items-center mt-1\">\r\n                          <span className={`text-xs px-2 py-0.5 rounded-full ${\r\n                            conversation.order.status === 'completed' \r\n                            ? 'bg-green-100 text-green-800' \r\n                            : conversation.order.status === 'in_progress' \r\n                            ? 'bg-blue-100 text-blue-800' \r\n                            : conversation.order.status === 'pending' \r\n                            ? 'bg-yellow-100 text-yellow-800'\r\n                            : conversation.order.status === 'under_review'\r\n                            ? 'bg-purple-100 text-purple-800'  \r\n                            : 'bg-gray-100 text-gray-800'\r\n                        }`}>\r\n                          Order: {conversation.order.status.replace('_', ' ')}\r\n                        </span>\r\n                        <span className=\"text-xs text-gray-500 ml-2 truncate\">\r\n                          {conversation.order.title}\r\n                        </span>\r\n                      </div>\r\n                    )}\r\n                    \r\n                    <p className={`text-sm truncate mt-1 ${hasUnread ? 'text-gray-900' : 'text-gray-500'}`}>\r\n                      {conversation.lastMessage ? (\r\n                        <>\r\n                          {conversation.lastMessage.sender._id === currentUser._id && \"You: \"}\r\n                          {conversation.lastMessage.content ? (\r\n                            conversation.lastMessage.content\r\n                          ) : (\r\n                            conversation.lastMessage.attachments?.length ? (\r\n                              `${conversation.lastMessage.attachments.length} attachment${conversation.lastMessage.attachments.length !== 1 ? 's' : ''}`\r\n                            ) : 'Empty message'\r\n                          )}\r\n                        </>\r\n                      ) : (\r\n                        'No messages yet'\r\n                      )}\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n              </Link>\r\n            );\r\n          })}\r\n        </div>\r\n      )}\r\n    </div>\r\n  </div>\r\n);\r\n};\r\n\r\nexport default Messages;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}